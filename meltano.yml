version: 1
send_anonymous_usage_stats: true
project_id: target-redshift
default_environment: test
environments:
- name: test
plugins:
  extractors:
  - name: tap-aircall
    variant: ticketswap
    pip_url: git+https://github.com/TicketSwap/tap-aircall.git
    config:
      start_date: '2024-03-27T00:00:00Z'
      stream_maps:
        calls:
          is_assist_you: str(raw_digits == "+31 20 532 2440")
          raw_digits: __NULL__
    load_schema: aircall_test_2
    select:
    - calls.*

  loaders:
  - name: target-redshift
    namespace: target_redshift
    pip_url: -e .
    capabilities:
    - about
    - stream-maps
    - record-flattening
    config:
      user: data_jobs
      password: $TARGET_REDSHIFT_PASSWORD
      host: 127.0.0.1
      port: "5001"
      dbname: reporting
      aws_redshift_copy_role_arn: arn:aws:iam::573569180693:role/AllowRedshiftToAccessS3Bucket
      s3_bucket: ticketswap-redshift-reporting
      s3_key_prefix: meltano-staging-test
      flattening_enabled: true
      flattening_max_depth: 5
      ssl_mode: prefer
      ssl_enable: true
